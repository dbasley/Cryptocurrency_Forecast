---
title: "Bitcoin EDA"
author: "Devin Basley"
date: "2024-04-01"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Hypotheses

1. Bitcoin Close Price will continue to increase by end of 2024, and March 2026

2. Smaller/Other Cryptocurrencies follow the performance of Bitcoin

3. Bitcoin Log Returns follow volatility clustering
 
 
# Bitcoin EDA


## Load Data
```{r}
bitcoin <- read.csv("~/Downloads/Time Series/Cryptocurrency_Forecast/bitcoin_history.csv")

smaller_crypto <- read.csv("~/Downloads/Time Series/Cryptocurrency_Forecast/smaller_crypto.csv")

bnb <- smaller_crypto %>%
  filter(name == "BNB")

ethereum <- smaller_crypto %>%
  filter(name == "Ethereum")


```


# Convert Bitcoin, BNB, Ethereum log close price to TS

```{r}

bitcoin_close <- ts(log(bitcoin$close), start = c(2015,1), end = c(2023,12), frequency = 365)
bnb_close <- ts(log(bnb$close), start = c(2017, 1), end = c(2023,12), frequency = 365)
ethereum_close <- ts(log(ethereum$close), start = c(2015, 1), end = c(2023,12), frequency = 365)

time1 <- time(ts(start = c(2015, 1), end = c(2023, 12), frequency = 365))
time2 <- time(ts(start = c(2017, 1), end = c(2023, 12), frequency = 365))


plot(bitcoin_close, col = "black", ylim = c(0,15), 
     xlab = "Date", 
     ylab = "Logged Coin Close Price", 
     main = "Cryptocurrency Logged Close Price Over Time")
lines(bnb_close, col = "skyblue")
lines(ethereum_close, col = "red")
legend("topleft", 
       legend = c("Bitcoin", "BNB", "Ethereum"), 
       col = c("black", "skyblue", "red"), lty = 1)


```


# Detrended Linear Regression Model

```{r}
bitcoin_lm_fit <- lm(bitcoin_close ~ time1, data = bitcoin)
bitcoin_detrend <- bitcoin_close - fitted(bitcoin_lm_fit)



bnb_lm_fit <- lm(bnb_close ~ time2, data = bnb)
bnb_detrend <- bnb_close - fitted(bnb_lm_fit)

ether_lm_fit <- lm(ethereum_close ~ time1, data = ethereum)
ether_detrend <- ethereum_close - fitted(ether_lm_fit)

par(mfrow = c(3,1))
plot(bitcoin_detrend)
plot(bnb_detrend)
plot(ether_detrend)

```





# Vector AR Model

```{r}
library(vars)

detrend_crypto <- data.frame(bitcoin_detrend, ether_detrend)

var_analysis <- VARselect(detrend_crypto, type = "none")

var_analysis$selection

crypto_var <- VAR(detrend_crypto, type = "none", p = 1)

summary(crypto_var)

```






# Bitcoin Log Returns

```{r}

bitcoin_log_return <- diff(log(bitcoin$close))

bitcoin_log_return <- ts(bitcoin_log_return)


```

# Plot Bitcoin Close Price and Log Returns

```{r}

plot(bitcoin_close)

plot(bitcoin_log_return)

```

# Close Price ACF and PACF

```{r}


acf(bitcoin_close)
pacf(bitcoin_close)




```


# Bitcoin Log Returns ACF and PACF plots

```{r}
par(mfrow=c(2,2))
acf(bitcoin_log_return, main = "ACF of Bitcoin Log Return")
pacf(bitcoin_log_return, main = "PACF of Bitcoin Log Return")
acf(bitcoin_log_return^2, main = "ACF of Bitcoin Log Return Squared")
pacf(bitcoin_log_return^2, main = "PACF of Bitcoin Log Return Squared")



```

# ARMA Model

```{r}

library(forecast)




returns_arma <- auto.arima(bitcoin_log_return^2, max.p = 5, max.q = 5, 
                  max.order = 10, stationary = T, 
                  seasonal = F, trace = T, stepwise = F, 
                  approximation = F)

```

# Bitcoin Squared Log Returns Residuals Checks

```{r}

# Fit ARMA(3,0,3) model
arma_model <- arima(bitcoin_log_return^2, order=c(3,0,3))
residuals_arma <- residuals(arma_model)

# Squared residuals
squared_residuals <- residuals_arma^2

# ACF and PACF plots
acf_sqr_residuals <- acf(squared_residuals, main = "ACF of Log Returns Squared Residuals")
pacf_sqr_residuals <- pacf(squared_residuals, main = "PACF of Log Returns Squared Residuals")


```


# Bitcoin Returns GARCH Model

```{r}

library(fGarch)
library(xts)

# Define GARCH model 
garch_fit <- garchFit(~garch(1, 1), 
                        data = bitcoin_log_return)


gfit_parameters <- (garch_fit@fit)$matcoe

gfit_parameters


# Summarize the model
summary(garch_fit)

# Plot Garch Model
#plot(garch_fit, which = 1)
plot(garch_fit, which = 2)


```


# Visualize GARCH fit Bitcoin Log Returns

```{r}

std_t <- garch_fit@sigma.t

plot(bitcoin_log_return, main = "Envelope based on GARCH(1,1)")
lines(std_t, col = "skyblue", pch = 30)

```


